# F0.2: SQLDelight Setup

## Objective
Add SQLDelight for local database storage with initial schema for reminders.

## Requirements
- [ ] SQLDelight plugin added to build configuration
- [ ] Database driver configured for Android and iOS
- [ ] Initial `Reminder` table created
- [ ] Type-safe queries generated successfully
- [ ] Database can be created and accessed on both platforms

## Dependencies to Add

### gradle/libs.versions.toml
```toml
[versions]
sqldelight = "2.0.1"
uuid = "0.8.2"

[libraries]
uuid = { module = "com.benasher44:uuid", version.ref = "uuid" }
sqldelight-runtime = { module = "app.cash.sqldelight:runtime", version.ref = "sqldelight" }
sqldelight-coroutines = { module = "app.cash.sqldelight:coroutines-extensions", version.ref = "sqldelight" }
sqldelight-android = { module = "app.cash.sqldelight:android-driver", version.ref = "sqldelight" }
sqldelight-native = { module = "app.cash.sqldelight:native-driver", version.ref = "sqldelight" }

[plugins]
sqldelight = { id = "app.cash.sqldelight", version.ref = "sqldelight" }
```

### composeApp/build.gradle.kts
```kotlin
plugins {
    alias(libs.plugins.sqldelight)
}

sqldelight {
    databases {
        create("RemindersDatabase") {
            packageName.set("com.cooleymd.reminders.data.local")
        }
    }
}
```

## Schema to Create

### composeApp/src/commonMain/sqldelight/com/cooleymd/reminders/data/local/Reminder.sq
```sql
CREATE TABLE Reminder (
    id TEXT NOT NULL PRIMARY KEY,
    title TEXT NOT NULL,
    notes TEXT,
    scheduledAt INTEGER NOT NULL,
    recurrenceRule TEXT,
    status TEXT NOT NULL DEFAULT 'pending',
    snoozedUntil INTEGER,
    completedAt INTEGER,
    labelId TEXT,
    priority TEXT NOT NULL DEFAULT 'normal',
    createdAt INTEGER NOT NULL,
    updatedAt INTEGER NOT NULL
);

selectAll:
SELECT * FROM Reminder ORDER BY scheduledAt ASC;

selectById:
SELECT * FROM Reminder WHERE id = ?;

insert:
INSERT INTO Reminder(id, title, notes, scheduledAt, recurrenceRule, status, snoozedUntil, completedAt, labelId, priority, createdAt, updatedAt)
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);

update:
UPDATE Reminder SET title = ?, notes = ?, scheduledAt = ?, recurrenceRule = ?, status = ?, snoozedUntil = ?, completedAt = ?, labelId = ?, priority = ?, updatedAt = ? WHERE id = ?;

delete:
DELETE FROM Reminder WHERE id = ?;
```

## Platform Drivers

### androidMain
```kotlin
actual fun createDriver(): SqlDriver {
    return AndroidSqliteDriver(RemindersDatabase.Schema, context, "reminders.db")
}
```

### iosMain
```kotlin
actual fun createDriver(): SqlDriver {
    return NativeSqliteDriver(RemindersDatabase.Schema, "reminders.db")
}
```

## Verification
```bash
./gradlew generateCommonMainRemindersDatabase
./gradlew build
```

## Files to Create/Modify
- `gradle/libs.versions.toml` - add sqldelight dependencies
- `build.gradle.kts` (root) - add sqldelight plugin
- `composeApp/build.gradle.kts` - configure sqldelight
- `composeApp/src/commonMain/sqldelight/.../Reminder.sq` - schema
- `composeApp/src/commonMain/kotlin/.../DatabaseDriver.kt` - expect
- `composeApp/src/androidMain/kotlin/.../DatabaseDriver.kt` - actual
- `composeApp/src/iosMain/kotlin/.../DatabaseDriver.kt` - actual
