# F1.4: Use Cases - Basic CRUD

## Objective
Create use cases for basic reminder CRUD operations.

## Dependencies
- F1.1 (ReminderRepository)

## Requirements
- [ ] `CreateReminderUseCase`
- [ ] `UpdateReminderUseCase`
- [ ] `DeleteReminderUseCase`
- [ ] `GetRemindersUseCase` with filtering options
- [ ] Use cases injected via Koin
- [ ] Unit tests for each use case

## Use Cases

### domain/usecase/CreateReminderUseCase.kt
```kotlin
package com.cooleymd.reminders.domain.usecase

import com.cooleymd.reminders.domain.model.Reminder
import com.cooleymd.reminders.domain.repository.ReminderRepository
import kotlinx.datetime.Clock
import java.util.UUID

class CreateReminderUseCase(
    private val reminderRepository: ReminderRepository
) {
    suspend operator fun invoke(
        title: String,
        notes: String? = null,
        scheduledAt: kotlinx.datetime.Instant,
        recurrenceRule: RecurrenceRule? = null,
        labelId: String? = null,
        priority: Priority = Priority.NORMAL
    ): Reminder {
        require(title.isNotBlank()) { "Title cannot be blank" }
        require(scheduledAt > Clock.System.now()) { "Scheduled time must be in the future" }

        val now = Clock.System.now()
        val reminder = Reminder(
            id = UUID.randomUUID().toString(),
            title = title.trim(),
            notes = notes?.trim(),
            scheduledAt = scheduledAt,
            recurrenceRule = recurrenceRule,
            status = ReminderStatus.PENDING,
            labelId = labelId,
            priority = priority,
            createdAt = now,
            updatedAt = now
        )

        reminderRepository.insertReminder(reminder)
        return reminder
    }
}
```

### domain/usecase/UpdateReminderUseCase.kt
```kotlin
class UpdateReminderUseCase(
    private val reminderRepository: ReminderRepository
) {
    suspend operator fun invoke(reminder: Reminder): Reminder {
        val updated = reminder.copy(updatedAt = Clock.System.now())
        reminderRepository.updateReminder(updated)
        return updated
    }
}
```

### domain/usecase/DeleteReminderUseCase.kt
```kotlin
class DeleteReminderUseCase(
    private val reminderRepository: ReminderRepository
) {
    suspend operator fun invoke(reminderId: String) {
        reminderRepository.deleteReminder(reminderId)
    }
}
```

### domain/usecase/GetRemindersUseCase.kt
```kotlin
class GetRemindersUseCase(
    private val reminderRepository: ReminderRepository
) {
    operator fun invoke(
        filter: ReminderFilter = ReminderFilter.All
    ): Flow<List<Reminder>> {
        return reminderRepository.getAllReminders()
            .map { reminders ->
                when (filter) {
                    ReminderFilter.All -> reminders
                    ReminderFilter.Today -> reminders.filter { it.isToday() }
                    ReminderFilter.Upcoming -> reminders.filter { it.isUpcoming() }
                    ReminderFilter.Completed -> reminders.filter { it.status == ReminderStatus.COMPLETED }
                    is ReminderFilter.ByLabel -> reminders.filter { it.labelId == filter.labelId }
                }
            }
    }
}

sealed class ReminderFilter {
    object All : ReminderFilter()
    object Today : ReminderFilter()
    object Upcoming : ReminderFilter()
    object Completed : ReminderFilter()
    data class ByLabel(val labelId: String) : ReminderFilter()
}
```

## Koin Registration

Add to AppModule.kt:
```kotlin
factory { CreateReminderUseCase(get()) }
factory { UpdateReminderUseCase(get()) }
factory { DeleteReminderUseCase(get()) }
factory { GetRemindersUseCase(get()) }
```

## Tests

For each use case:
- Test happy path
- Test validation errors
- Test edge cases

## Verification
```bash
./gradlew build
./gradlew :composeApp:testDebugUnitTest --tests "*UseCase*"
```

## Files to Create
- `composeApp/src/commonMain/kotlin/.../domain/usecase/CreateReminderUseCase.kt`
- `composeApp/src/commonMain/kotlin/.../domain/usecase/UpdateReminderUseCase.kt`
- `composeApp/src/commonMain/kotlin/.../domain/usecase/DeleteReminderUseCase.kt`
- `composeApp/src/commonMain/kotlin/.../domain/usecase/GetRemindersUseCase.kt`
- `composeApp/src/commonMain/kotlin/.../domain/usecase/ReminderFilter.kt`
- `composeApp/src/commonTest/kotlin/.../CreateReminderUseCaseTest.kt`
- `composeApp/src/commonTest/kotlin/.../GetRemindersUseCaseTest.kt`
- Update `di/AppModule.kt`
