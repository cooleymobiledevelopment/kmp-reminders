# F2.5: Android Labels Management

## Objective
Implement labels list screen with CRUD operations.

## Dependencies
- F2.1 (Navigation)
- F1.3 (LabelRepository)

## Requirements
- [ ] Labels list screen with all labels
- [ ] Add new label with name and color picker
- [ ] Edit existing label
- [ ] Delete label with confirmation
- [ ] Color picker component
- [ ] Filter reminders by label (in home screen)

## Labels ViewModel

### presentation/labels/LabelsViewModel.kt
```kotlin
class LabelsViewModel(
    private val labelRepository: LabelRepository
) : ViewModel() {

    private val _uiState = MutableStateFlow(LabelsUiState())
    val uiState: StateFlow<LabelsUiState> = _uiState.asStateFlow()

    init {
        loadLabels()
    }

    private fun loadLabels() {
        viewModelScope.launch {
            labelRepository.getAllLabels().collect { labels ->
                _uiState.update { it.copy(labels = labels, isLoading = false) }
            }
        }
    }

    fun onAddLabel(name: String, color: String) {
        viewModelScope.launch {
            val label = Label(
                id = UUID.randomUUID().toString(),
                name = name,
                color = color,
                createdAt = Clock.System.now(),
                updatedAt = Clock.System.now()
            )
            labelRepository.insertLabel(label)
        }
    }

    fun onUpdateLabel(label: Label) {
        viewModelScope.launch {
            labelRepository.updateLabel(label.copy(updatedAt = Clock.System.now()))
        }
    }

    fun onDeleteLabel(id: String) {
        viewModelScope.launch {
            labelRepository.deleteLabel(id)
        }
    }
}

data class LabelsUiState(
    val labels: List<Label> = emptyList(),
    val isLoading: Boolean = true
)
```

## Labels Screen

### presentation/labels/LabelsScreen.kt
```kotlin
@Composable
fun LabelsScreen(
    viewModel: LabelsViewModel = koinViewModel()
) {
    val uiState by viewModel.uiState.collectAsState()
    var showAddDialog by remember { mutableStateOf(false) }
    var editingLabel by remember { mutableStateOf<Label?>(null) }

    Scaffold(
        topBar = {
            TopAppBar(title = { Text("Labels") })
        },
        floatingActionButton = {
            FloatingActionButton(onClick = { showAddDialog = true }) {
                Icon(Icons.Default.Add, "Add label")
            }
        }
    ) { padding ->
        LazyColumn(modifier = Modifier.padding(padding)) {
            items(uiState.labels, key = { it.id }) { label ->
                LabelItem(
                    label = label,
                    onClick = { editingLabel = label },
                    onDelete = { viewModel.onDeleteLabel(label.id) }
                )
            }
        }
    }

    // Add dialog
    if (showAddDialog) {
        LabelDialog(
            label = null,
            onDismiss = { showAddDialog = false },
            onSave = { name, color ->
                viewModel.onAddLabel(name, color)
                showAddDialog = false
            }
        )
    }

    // Edit dialog
    editingLabel?.let { label ->
        LabelDialog(
            label = label,
            onDismiss = { editingLabel = null },
            onSave = { name, color ->
                viewModel.onUpdateLabel(label.copy(name = name, color = color))
                editingLabel = null
            }
        )
    }
}
```

## Label Item

### presentation/labels/LabelItem.kt
```kotlin
@Composable
fun LabelItem(
    label: Label,
    onClick: () -> Unit,
    onDelete: () -> Unit
) {
    var showDeleteConfirm by remember { mutableStateOf(false) }

    ListItem(
        headlineContent = { Text(label.name) },
        leadingContent = {
            Box(
                modifier = Modifier
                    .size(24.dp)
                    .background(
                        color = Color(android.graphics.Color.parseColor(label.color)),
                        shape = CircleShape
                    )
            )
        },
        trailingContent = {
            IconButton(onClick = { showDeleteConfirm = true }) {
                Icon(Icons.Default.Delete, "Delete")
            }
        },
        modifier = Modifier.clickable(onClick = onClick)
    )

    if (showDeleteConfirm) {
        DeleteConfirmDialog(
            onConfirm = {
                onDelete()
                showDeleteConfirm = false
            },
            onDismiss = { showDeleteConfirm = false }
        )
    }
}
```

## Label Dialog with Color Picker

### presentation/labels/LabelDialog.kt
```kotlin
@Composable
fun LabelDialog(
    label: Label?,
    onDismiss: () -> Unit,
    onSave: (name: String, color: String) -> Unit
) {
    var name by remember { mutableStateOf(label?.name ?: "") }
    var selectedColor by remember { mutableStateOf(label?.color ?: "#FF5722") }

    AlertDialog(
        onDismissRequest = onDismiss,
        title = { Text(if (label == null) "New Label" else "Edit Label") },
        text = {
            Column {
                OutlinedTextField(
                    value = name,
                    onValueChange = { name = it },
                    label = { Text("Label name") },
                    modifier = Modifier.fillMaxWidth()
                )
                Spacer(Modifier.height(16.dp))
                Text("Color", style = MaterialTheme.typography.labelMedium)
                ColorPicker(
                    selectedColor = selectedColor,
                    onColorSelected = { selectedColor = it }
                )
            }
        },
        confirmButton = {
            TextButton(
                onClick = { onSave(name, selectedColor) },
                enabled = name.isNotBlank()
            ) {
                Text("Save")
            }
        },
        dismissButton = {
            TextButton(onClick = onDismiss) {
                Text("Cancel")
            }
        }
    )
}
```

## Color Picker

### presentation/labels/ColorPicker.kt
```kotlin
@Composable
fun ColorPicker(
    selectedColor: String,
    onColorSelected: (String) -> Unit
) {
    val colors = listOf(
        "#F44336", "#E91E63", "#9C27B0", "#673AB7",
        "#3F51B5", "#2196F3", "#03A9F4", "#00BCD4",
        "#009688", "#4CAF50", "#8BC34A", "#CDDC39",
        "#FFEB3B", "#FFC107", "#FF9800", "#FF5722"
    )

    LazyVerticalGrid(
        columns = GridCells.Fixed(8),
        modifier = Modifier.height(80.dp)
    ) {
        items(colors) { color ->
            Box(
                modifier = Modifier
                    .size(32.dp)
                    .padding(2.dp)
                    .background(
                        color = Color(android.graphics.Color.parseColor(color)),
                        shape = CircleShape
                    )
                    .border(
                        width = if (color == selectedColor) 2.dp else 0.dp,
                        color = MaterialTheme.colorScheme.primary,
                        shape = CircleShape
                    )
                    .clickable { onColorSelected(color) }
            )
        }
    }
}
```

## Verification
```bash
./gradlew :composeApp:installDebug
# Add new label with color
# Edit existing label
# Delete label
```

## Files to Create
- `composeApp/src/androidMain/kotlin/.../presentation/labels/LabelsViewModel.kt`
- `composeApp/src/androidMain/kotlin/.../presentation/labels/LabelsUiState.kt`
- `composeApp/src/androidMain/kotlin/.../presentation/labels/LabelsScreen.kt`
- `composeApp/src/androidMain/kotlin/.../presentation/labels/LabelItem.kt`
- `composeApp/src/androidMain/kotlin/.../presentation/labels/LabelDialog.kt`
- `composeApp/src/androidMain/kotlin/.../presentation/labels/ColorPicker.kt`
- Update `di/AppModule.kt`
